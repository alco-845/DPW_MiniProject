<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marital | Improve Your Style</title>
    <!-- my css -->
    <link rel="stylesheet" href="style.css" />
    <!-- icon css -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
    />
    <!-- bootstrap css -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0"
      crossorigin="anonymous"
    />
    <!-- script bootstap -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
      crossorigin="anonymous"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  </head>
  <body>
    <!-- navbar -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark p-md-3">
      <div class="container">
        <a class="navbar-brand" href="#">
          <img src="img/logo.png" alt="logo" width="50" height="50" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <div class="mx-auto"></div>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="landingPage.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link cart" href="checkout.html"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="25"
                  height="20"
                  fill="currentColor"
                  class="bi bi-cart-fill"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
                  /></svg
              ></a>
            </li>
            <li class="nav-item">
              <a id="display-name" class="nav-link" href="#"></a>
            </li>
            <li class="nav-item">
              <a id="signin" href="login-page.html">
                <button id="login" type="button" class="btn btn-light">
                  Sign in
                </button>
                <button id="logout" type="button" class="btn btn-light">
                  Log out
                </button>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- thanos content -->
    <section id="athena" align="center">
      <a href="">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="60"
          height="60"
          fill="white"
          class="bi bi-cart-fill"
          viewBox="0 0 16 16"
        >
          <path
            d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
          />
        </svg>
      </a>
      <div class="container">
        <a href="">
          <h1>Checkout</h1>
        </a>
        <div class="card" style="height: 30%">
          <h2 id="txtEmpty" style="margin: 5%">Cart is empty</h2>
          <table class="card-body table" id="cartTable" style="visibility: hidden">
            <thead>
              <tr>
                <th>#</th>
                <th>Product Image</th>
                <th>Product Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
                <th>Delete</th>
              </tr>
            </thead>
            <tbody id="cartBody"></tbody>
            <tfoot id="cartFooter"></tfoot>
          </table>
        </div>
      </div>
      <img src="img/bottom.png" alt="bottom" width="80px" height="80px" />
    </section>
    <!-- footer -->
    <footer>
      <div class="container" style="padding: 10px; text-align: center">
        <a class="link" href="landingPage.html">Home</a>
      </div>
      <div class="container" style="text-align: center">
        <h6 id="sosmed" style="color: gray">Connect With Us</h6>
        <a id="sosmed" href="https://www.instagram.com" target="_blank"
          ><img
            src="img/ig.png"
            alt="instagram"
            style="width: 20px; height: 20px"
        /></a>
        <a id="sosmed" href="https://www.twitter.com" target="_blank"
          ><img
            src="img/twitter.png"
            alt="twitter"
            style="width: 20px; height: 20px"
        /></a>
        <a id="sosmed" href="https://www.youtube.com" target="_blank"
          ><img src="img/yt.png" alt="yt" style="width: 20px; height: 20px"
        /></a>
        <a id="sosmed" href="https://www.facebook.com" target="_blank"
          ><img src="img/fb.png" alt="fb" style="width: 20px; height: 20px"
        /></a>
      </div>
      <p>
        <script>
          document.write(new Date().getFullYear())
          </script> | Marital | Online God Clothes
        <a class="link" href="#">| Privasi Policy</a>
      </p>
    </footer>
    <script type="text/javascript">
      window.onload = (event) => {
        // const login = document.querySelector('#login');
        if (localStorage.getItem("login") == undefined) {
          document.querySelector("#login").style.display = "block";
          document.querySelector("#logout").style.display = "none";
          document.querySelector(".cart").style.display = "none";
        } else {
          const welcome = document.querySelector("#display-name");
          welcome.innerHTML = "Welcome, " + localStorage.getItem("ID");
          document.querySelector("#login").style.display = "none";
          document.querySelector("#logout").style.display = "block";
          document.querySelector(".cart").style.display = "block";
        }
      };
      logout.addEventListener("click", (event) => {
        localStorage.removeItem("login");
        document.querySelector("#signin").setAttribute("href", "landingPage.html");
        localStorage.cart = [];
        location.reload();
      });

      var nav = document.querySelector("nav");

      window.addEventListener("scroll", function () {
        if (window.pageYOffset > 100) {
          nav.classList.add("bg-dark", "shadow");
        } else {
          nav.classList.remove("bg-dark", "shadow");
        }
      });

      // start cart
      var cart = [];
      $(function () {
        if (localStorage.cart) {
          cart = JSON.parse(localStorage.cart);
          showCart();
        }
      });

      function addItem() {
        var imageVal = $("#image").val();
        var nameVal = $("#product").val();
        var priceVal = parseInt($("#price").val());
        var quantVal = parseInt($("#qty").val());

        // update
        for (var i in cart) {
          if (cart[i].product == nameVal) {
            cart[i].quant += quantVal;
            showCart();
            saveCart();
            return;
          }
        }

        // create Object / dictionary
        var item = { image: imageVal, product: nameVal, price: priceVal, quant: quantVal };
        cart.push(item);

        saveCart();
        showCart();
      }

      function deleteItem(index) {
        cart.splice(index, 1);
        showCart();
        saveCart();
      }

      function saveCart() {
        if (window.localStorage) {
          localStorage.cart = JSON.stringify(cart);
        }
      }

      function addAmount(index) {
        cart[index].quant += 1;
        showCart();
        saveCart();
        return;
      }

      function minAmount(index) {
        if (cart[index].quant <= 1) {
          deleteItem(index);
        } else {
          cart[index].quant -= 1;
          showCart();
          saveCart();
          return;
        }
      }

      function getConfirmm() {
        var choice = confirm("Do you want to checkout?");
        if (choice == true) {
          localStorage.cart = [];
          document
            .querySelector("#next-page")
            .setAttribute("href", "landingPage.html");
          return true;
        }
      }

      function showCart() {
        if (cart.length == 0) {
          $("#cartTable").css("visibility", "hidden");
          $("#cartTable").empty();
          return;
        }
        $("#txtEmpty").css("display", "none");
        $("#cartTable").css("visibility", "visible");
        $("#cartBody").empty();
        var subTotal = 0;
        for (var i in cart) {
          var item = cart[i];
          var body =
          "<tr><td>" +
            (parseInt(i) + 1) +
            "</td><td>" +
              "<img style='height: 100px; width: 100px;' src='img/" + item.image + " '  />" +
            "</td><td>" +
            item.product +
            "</td><td>" +
            item.price +
            "</td><td>" +
            "<button class='bi bi-plus-lg btn btn-primary' onclick='addAmount(" +
            i +
            ")'></button>" +
            "&nbsp;&nbsp;&nbsp;" +
            item.quant +
            "&nbsp;&nbsp;&nbsp;" +
            "<button class='bi bi-dash-lg btn btn-danger' onclick='minAmount(" +
            i +
            ")'></button>" +
            "</td><td>" +
            item.quant * item.price +
            "</td><td>" +
            "<button class='bi bi-trash btn btn-warning' onclick='deleteItem(" +
            i +
            ")'></button></td></tr>";
          subTotal += item.quant * item.price;
          $("#cartBody").append(body);
        }
        $("#cartFooter").empty();
        var footer =
          "<tr><td colspan='5'><h3>Sub Total :</h3></td><td colspan='1'> " +
            subTotal +
          "</td><td><a id='next-page' onclick = 'getConfirmm();'><button class='btn btn-success'>Checkout</button></a></td></tr>";
        $("#cartFooter").append(footer);
      }
      // end of cart
    </script>
  </body>
</html>
